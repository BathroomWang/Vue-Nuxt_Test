<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ°´æœè´­ç‰©è½¦</title>
    <style>
        #app {
            margin-left: 30%;
        }

        #titleImg {
            position: relative;
            height: 150px;
            width: 600px;

            border: 1px solid #c4c4c4;
            border-radius: 0px;

            overflow: hidden;
        }
        .imgTop {
            position: absolute;
            top: -100px;
            margin: 0;
            padding: 0;
            width: 600px;
            object-fit: contain;
        }
        table {
            width: 600px;
            border-collapse: collapse;
        }
        th {
            height: 50px;
            border: 1px solid #D4D4D4   ;
            background-color: #E3E3E3 ;
            padding: 6px;
        }
        td {
            height: 60px;
            border: 1px solid #D4D4D4    ;
            padding: 6px;
            text-align: center;
        }
        #nothing {
            color: #787575;
        }
        .active {
            background-color: #D4D4D4;
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="titleImg">
            <img src="image\titleImg.jpg" alt="" class="imgTop">
        </div>
        <p>  ğŸ  / è´­ç‰©è½¦</p>
        <table>
            <thead>
                <tr><th style="width: 80px;">é€‰ä¸­</th> 
                    <th style="width: 100px;">åç§°</th> 
                    <th style="width: 100px;">å•ä»·</th> 
                    <th style="width: 120px;">ä¸ªæ•°</th> 
                    <th style="width: 80px;">å°è®¡</th> 
                    <th style="width: 120px;">æ“ä½œ</th> 
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item, index) in fruitsList" :key="item.id" :class="{active:item.isCheck}">
                    <td><input type="checkbox" v-model="item.isCheck"></td> 
                    <td>{{item.name}}</td> 
                    <td>{{item.price}}</td> 
                    <td>
                        <input type="button" value="-" @click="item.count >0 ?item.count-- : 0">
                        {{item.count}}
                        <input type="button" value="+" @click="item.count++">
                    </td> 
                    <td>{{item.price * item.count}}</td> 
                    <td>
                        <button @click="deleteFruit(item.id)">åˆ é™¤</button>
                    </td> 
                </tr>
            </tbody>
            <tfoot>
                <tr v-if="fruitsList.length === 0">
                    <td colspan="6"> 
                        <h2 id="nothing"> ğŸ›’ ç©ºç©ºå¦‚ä¹Ÿï¼Œä¹°ç‚¹ä»€ä¹ˆå§ï¼</h2>
                    </td>
                </tr>
                <tr v-else>
                    <td colspan="6"> 
                        <input type="checkbox" v-model="isAll">å…¨é€‰
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        æ€»ä»·ï¼šï¿¥ {{totalPrice}} å…ƒ &nbsp;&nbsp;
                        <button> ç»“ç®— ({{total}}) </button>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script>
    //æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé»˜è®¤æ•°ç»„ï¼Œé˜²æ­¢æœ¬åœ°å­˜å‚¨è¢«æ¸…ç©ºåï¼Œå‡ºç°nullå¼•ç”¨é—®é¢˜
    const defArr = [
                {
                    id:1001,
                    name:'è‹¹æœ',
                    price:2.00,
                    count:0,
                    isCheck:false,
                },
                {
                    id:1002,
                    name:'é¦™è•‰',
                    price:1.50,
                    count:0,
                    isCheck:false,
                },
                {
                    id:1003,
                    name:'è¥¿ç“œ',
                    price:10.00,
                    count:0,
                    isCheck:false,
                },
                {
                    id:1004,
                    name:'èŠ’æœ',
                    price:6.00,
                    count:0,
                    isCheck:false,
                }];
    const app = new Vue({
        el:'#app',
        data:{
            // fruitsListé¦–å…ˆå¯»æ‰¾æœ¬åœ°æŒä¹…åŒ–å‚¨å­˜çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„é»˜è®¤æ•°ç»„
            fruitsList: JSON.parse(localStorage.getItem('list')) || defArr
        },
        methods: {
            //åˆ é™¤æŒ‰é’®çš„æ–¹æ³•
            deleteFruit(id){
                this.fruitsList = this.fruitsList.filter(element => element.id !== id);
            },
        },
        computed: {
            isAll: {
                get(){
                    return this.fruitsList.every(element => element.isCheck);
                },
                set(bool){
                    if (bool) {
                        this.fruitsList.forEach(element => {
                        element.isCheck = true;});
                    }
                    else{
                        this.fruitsList.forEach(element => {
                        element.isCheck = false;});
                    }
                }
            },
            total(){
                let total = this.fruitsList.reduce(
                                            (sum,element) => element.isCheck == true ? sum + element.count : sum
                                            ,0 );
                return total;
            },
            totalPrice(){
                let totalP = this.fruitsList.reduce(
                                            (sum,element) => element.isCheck == true ? sum + element.count * element.price : sum
                                            ,0 );
                return totalP;
            }
        },
        //è¿™éƒ¨åˆ†æ˜¯éœ€æ±‚ä¸­çš„å¯¹é¡µé¢æ•°æ®çš„æŒä¹…åŒ–
        //å› ä¸ºæˆ‘ä»¬å®é™…ä¸Šæ²¡æœ‰çœŸæ­£çš„åç«¯å’Œæ•°æ®åº“ï¼Œå› æ­¤æˆ‘ä»¬å…ˆå°†æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°çš„localStorageä¸­
        //å‚¨å­˜æ˜¯setItem,ä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼Œå¹¶æ³¨æ„å°†æˆ‘ä»¬çš„å¯¹è±¡ç¼–ç¨‹jsonå­—ç¬¦ä¸²
        watch: {
            fruitsList: {
                deep:true,
                handler(newValue) {
                    localStorage.setItem('list',JSON.stringify(newValue));
                }
            },
        },
    })
</script>

</html>